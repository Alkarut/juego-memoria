<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CLEANMANT ULTIMATE</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body{
margin:0;
background:black;
color:white;
text-align:center;
font-family:'Press Start 2P', cursive;
overflow:hidden;
}
canvas{
background:black;
display:block;
margin:auto;
image-rendering:pixelated;
border:4px solid cyan;
}
button{
margin-top:40px;
padding:20px;
font-family:'Press Start 2P';
background:cyan;
border:none;
cursor:pointer;
}
</style>
</head>
<body>

<div id="menu">
<h1>CLEANMANT ULTIMATE</h1>
<button onclick="startGame()">JUGAR</button>
</div>

<canvas id="game" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
ctx.imageSmoothingEnabled = false;

let level=1;
let lives=3;
let dust=[];
let totalDust=0;
let isFiring=false;
let heat=0;
let boss=null;
let gameRunning=false;

let sponge={x:180,y:520};

canvas.addEventListener("mousemove",e=>{
let rect=canvas.getBoundingClientRect();
sponge.x=(e.clientX-rect.left)-20;
});
canvas.addEventListener("mousedown",()=>isFiring=true);
canvas.addEventListener("mouseup",()=>isFiring=false);

function startGame(){
document.getElementById("menu").style.display="none";
canvas.style.display="block";
gameRunning=true;
createLevel();
update();
}

function createLevel(){
dust=[];
for(let i=0;i<30+level*10;i++){
dust.push({x:Math.random()*380,y:Math.random()*400});
}
totalDust=dust.length;

if(level==5){
boss={x:150,y:80,life:100};
}
}

function drawBackground(){
ctx.fillStyle="#220000";
ctx.fillRect(0,0,400,600);
ctx.fillStyle="#660000";
for(let i=0;i<40;i++){
ctx.fillRect((i*40+Date.now()/20)%400,(i*30)%600,4,4);
}
}

function drawProgress(){
let progress=Math.floor((1-(dust.length/totalDust))*100);
ctx.fillStyle="white";
ctx.fillText("LVL "+level+"/5",10,20);
ctx.fillText("VIDAS:"+lives,250,20);
ctx.fillStyle="gray";
ctx.fillRect(100,30,200,10);
ctx.fillStyle="lime";
ctx.fillRect(100,30,2*progress,10);
}

function drawDust(){
ctx.fillStyle="#8b4513";
dust.forEach(d=>ctx.fillRect(d.x,d.y,4,4));
}

function drawSponge(){
ctx.fillStyle="yellow";
ctx.fillRect(sponge.x,sponge.y,40,30);
}

function drawLaser(){
if(isFiring && heat<100){
heat+=1;
ctx.fillStyle="cyan";
let y=sponge.y;
while(y>0){
ctx.fillRect(sponge.x+18+Math.random()*4-2,y,4,8);
y-=10;
}
dust=dust.filter(d=>!(Math.abs(d.x-(sponge.x+20))<20 && d.y<sponge.y));

if(level==5 && boss){
boss.life-=0.2;
}
}else{
heat-=2;
}
heat=Math.max(0,Math.min(100,heat));

if(heat>=100){
ctx.fillStyle="orange";
ctx.fillText("SOBRECALENTAMIENTO!",20,580);
isFiring=false;
}
}

function drawBoss(){
if(!boss) return;
ctx.fillStyle="red";
ctx.fillRect(boss.x,boss.y,100,60);
ctx.fillStyle="white";
ctx.fillRect(boss.x+20,boss.y+20,10,10);
ctx.fillRect(boss.x+60,boss.y+20,10,10);

ctx.fillStyle="black";
ctx.fillRect(boss.x+40,boss.y+40,20,10);

ctx.fillStyle="red";
ctx.fillRect(100,50,200,10);
ctx.fillStyle="lime";
ctx.fillRect(100,50,2*boss.life,10);

if(boss.life<=0){
victory();
}
}

function victory(){
gameRunning=false;
ctx.fillStyle="black";
ctx.fillRect(0,0,400,600);

ctx.fillStyle="gold";
ctx.font="18px 'Press Start 2P'";
ctx.fillText("ðŸ† LA LIMPIEZA",50,250);
ctx.fillText("FUE EXITOSA",70,300);

let y=-50;
function animate(){
ctx.clearRect(0,200,400,200);
ctx.fillText("ðŸ†",180,y);
y+=5;
if(y<260)requestAnimationFrame(animate);
}
animate();
}

function update(){
if(!gameRunning)return;

drawBackground();
drawProgress();
drawDust();
drawSponge();
drawLaser();
drawBoss();

if(dust.length==0 && level<5){
level++;
createLevel();
}

requestAnimationFrame(update);
}
</script>
</body>
</html>
